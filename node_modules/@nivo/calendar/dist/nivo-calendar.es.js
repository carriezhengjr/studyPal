import{alignBox as e,Container as t,useTheme as o,useDimensions as n,useValueFormatter as i,SvgWrapper as r,ResponsiveWrapper as a,degreesToRadians as d,isCursorInRect as l,getRelativeCursor as c}from"@nivo/core";import{BoxLegendSvg as h,renderLegendToCanvas as u}from"@nivo/legends";import*as s from"react";import{memo as g,useCallback as f,useMemo as m,createElement as v,useRef as y,useState as p,useEffect as x}from"react";import{jsx as b,Fragment as S,jsxs as w}from"react/jsx-runtime";import{useTooltip as L,BasicTooltip as W}from"@nivo/tooltip";import{timeFormat as M}from"d3-time-format";import{scaleQuantize as C}from"d3-scale";import k from"lodash/range";import z from"lodash/memoize";import V from"lodash/isDate";import{timeWeek as O,timeYear as I,timeWeeks as H,timeDays as D,timeMonths as B,timeDay as E}from"d3-time";function P(){return P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},P.apply(this,arguments)}function F(e,t){if(null==e)return{};var o,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(i[o]=e[o]);return i}var R,T=g((function(e){var t=e.years,o=e.legend,n=e.theme;return b(S,{children:t.map((function(e){return b("text",{transform:"translate("+e.x+","+e.y+") rotate("+e.rotation+")",textAnchor:"middle",style:n.labels.text,children:o(e.year)},e.year)}))})})),Y=g((function(e){var t=e.path,o=e.borderWidth,n=e.borderColor;return b("path",{d:t,style:{fill:"none",strokeWidth:o,stroke:n,pointerEvents:"none"}})})),j=g((function(e){var t=e.months,o=e.legend,n=e.theme;return b(S,{children:t.map((function(e){return b("text",{transform:"translate("+e.x+","+e.y+") rotate("+e.rotation+")",textAnchor:"middle",style:n.labels.text,children:o(e.year,e.month,e.date)},e.date.toString()+".legend")}))})})),q=g((function(e){var t=e.data,o=e.x,n=e.y,i=e.size,r=e.color,a=e.borderWidth,d=e.borderColor,l=e.isInteractive,c=e.tooltip,h=e.onMouseEnter,u=e.onMouseMove,g=e.onMouseLeave,m=e.onClick,v=e.formatValue,y=L(),p=y.showTooltipFromEvent,x=y.hideTooltip,S=f((function(e){if("value"in t){var o=P({},t,{value:v(t.value),data:P({},t.data)});p(s.createElement(c,P({},o)),e),null==h||h(t,e)}}),[p,c,t,h,v]),w=f((function(e){if("value"in t){var o=P({},t,{value:v(t.value),data:P({},t.data)});p(s.createElement(c,P({},o)),e),u&&u(t,e)}}),[p,c,t,u,v]),W=f((function(e){"value"in t&&(x(),null==g||g(t,e))}),[x,t,g]),M=f((function(e){return null==m?void 0:m(t,e)}),[t,m]);return b("rect",{x:o,y:n,width:i,height:i,style:{fill:r,strokeWidth:a,stroke:d},onMouseEnter:l?S:void 0,onMouseMove:l?w:void 0,onMouseLeave:l?W:void 0,onClick:l?M:void 0})})),A=g((function(e){var t=e.value,o=e.day,n=e.color;return void 0===t||isNaN(Number(t))?null:b(W,{id:o,value:t,color:n,enableChip:!0})})),X=M("%b"),N={colors:["#61cdbb","#97e3d5","#e8c1a0","#f47560"],align:"center",direction:"horizontal",emptyColor:"#fff",minValue:0,maxValue:"auto",yearSpacing:30,yearLegend:function(e){return e},yearLegendPosition:"before",yearLegendOffset:10,monthBorderWidth:2,monthBorderColor:"#000",monthSpacing:0,monthLegend:function(e,t,o){return X(o)},monthLegendPosition:"before",monthLegendOffset:10,daySpacing:0,dayBorderWidth:1,dayBorderColor:"#000",isInteractive:!0,legends:[],tooltip:A},Z=P({},N,{role:"img"}),G=P({},N,{pixelRatio:"undefined"!=typeof window&&null!=(R=window.devicePixelRatio)?R:1}),J=P({},Z,{dayBorderColor:"#fff",dayRadius:0,square:!0,weekdayLegendOffset:75}),K=function(e,t,o){var n=e.map((function(e){return e.value}));return["auto"===t?Math.min.apply(Math,n):t,"auto"===o?Math.max.apply(Math,n):o]},Q=z((function(e){var t,o=e.date,n=e.cellSize,i=e.yearIndex,r=e.yearSpacing,a=e.monthSpacing,d=e.daySpacing,l=e.direction,c=e.originX,h=e.originY,u=new Date(o.getFullYear(),o.getMonth()+1,0),s=O.count(I(o),o),g=O.count(I(u),u),f=o.getDay(),m=u.getDay(),v=c,y=h,p=i*(7*(n+d)+r),x=o.getMonth()*a;"horizontal"===l?(y+=p,v+=x):(y+=x,v+=p);var b={x:v,y:y,width:0,height:0};return"horizontal"===l?(t=["M"+(v+(s+1)*(n+d))+","+(y+f*(n+d)),"H"+(v+s*(n+d))+"V"+(y+7*(n+d)),"H"+(v+g*(n+d))+"V"+(y+(m+1)*(n+d)),"H"+(v+(g+1)*(n+d))+"V"+y,"H"+(v+(s+1)*(n+d))+"Z"].join(""),b.x=v+s*(n+d),b.width=v+(g+1)*(n+d)-b.x,b.height=7*(n+d)):(t=["M"+(v+f*(n+d))+","+(y+(s+1)*(n+d)),"H"+v+"V"+(y+(g+1)*(n+d)),"H"+(v+(m+1)*(n+d))+"V"+(y+g*(n+d)),"H"+(v+7*(n+d))+"V"+(y+s*(n+d)),"H"+(v+f*(n+d))+"Z"].join(""),b.y=y+s*(n+d),b.width=7*(n+d),b.height=y+(g+1)*(n+d)-b.y),{path:t,bbox:b}}),(function(e){var t=e.date,o=e.cellSize,n=e.yearIndex,i=e.yearSpacing,r=e.monthSpacing,a=e.daySpacing,d=e.direction,l=e.originX,c=e.originY;return t.toString()+"."+o+"."+n+"."+i+"."+r+"."+a+"."+d+"."+l+"."+c})),U=M("%Y-%m-%d"),$=function(t){var o,n=t.width,i=t.height,r=t.from,a=t.to,d=t.direction,l=t.yearSpacing,c=t.monthSpacing,h=t.daySpacing,u=t.align,s=V(r)?r:new Date(r),g=V(a)?a:new Date(a),f=k(s.getFullYear(),g.getFullYear()+1),m=Math.max.apply(Math,f.map((function(e){return H(new Date(e,0,1),new Date(e+1,0,1)).length})))+1,v=function(e){var t,o,n=e.width,i=e.height,r=e.direction,a=e.yearRange,d=e.yearSpacing,l=e.monthSpacing,c=e.daySpacing,h=e.maxWeeks;return"horizontal"===r?(t=(n-12*l-c*h)/h,o=(i-(a.length-1)*d-a.length*(8*c))/(7*a.length)):(t=(n-(a.length-1)*d-a.length*(8*c))/(7*a.length),o=(i-12*l-c*h)/h),Math.min(t,o)}({width:n,height:i,direction:d,yearRange:f,yearSpacing:l,monthSpacing:c,daySpacing:h,maxWeeks:m}),y=v*m+h*m+12*c,p=7*(v+h)*f.length+l*(f.length-1),x="horizontal"===d?y:p,b="horizontal"===d?p:y,S=e({x:0,y:0,width:x,height:b},{x:0,y:0,width:n,height:i},u),w=S[0],L=S[1];o="horizontal"===d?function(e,t,o,n){return function(i,r,a,d){return{x:i+O.count(I(a),a)*(e+n)+n/2+a.getMonth()*o,y:r+a.getDay()*(e+n)+n/2+d*(t+7*(e+n))}}}(v,l,c,h):function(e,t,o,n){return function(i,r,a,d){var l=O.count(I(a),a);return{x:i+a.getDay()*(e+n)+n/2+d*(t+7*(e+n)),y:r+l*(e+n)+n/2+a.getMonth()*o}}}(v,l,c,h);var W=[],M=[],C=[];return f.forEach((function(e,t){var n=new Date(e,0,1),i=new Date(e+1,0,1);C=C.concat(D(n,i).map((function(e){return P({date:e,day:U(e),size:v},o(w,L,e,t))})));var r=B(n,i).map((function(e){return P({date:e,year:e.getFullYear(),month:e.getMonth()},Q({originX:w,originY:L,date:e,direction:d,yearIndex:t,yearSpacing:l,monthSpacing:c,daySpacing:h,cellSize:v}))}));M=M.concat(r),W.push({year:e,bbox:{x:r[0].bbox.x,y:r[0].bbox.y,width:r[11].bbox.x-r[0].bbox.x+r[11].bbox.width,height:r[11].bbox.y-r[0].bbox.y+r[11].bbox.height}})})),{years:W,months:M,days:C,cellSize:v,calendarWidth:x,calendarHeight:b,originX:w,originY:L}},_=function(e){var t=e.days,o=e.data,n=e.colorScale,i=e.emptyColor;return t.map((function(e){var t=o.find((function(t){return t.day===e.day}));return P({},e,t?{color:n(t.value),data:t,value:t.value}:{color:i})}))},ee=function(e){var t=e.years,o=e.direction,n=e.position,i=e.offset;return t.map((function(e){var t=0,r=0,a=0;return"horizontal"===o&&"before"===n?(t=e.bbox.x-i,r=e.bbox.y+e.bbox.height/2,a=-90):"horizontal"===o&&"after"===n?(t=e.bbox.x+e.bbox.width+i,r=e.bbox.y+e.bbox.height/2,a=-90):"vertical"===o&&"before"===n?(t=e.bbox.x+e.bbox.width/2,r=e.bbox.y-i):(t=e.bbox.x+e.bbox.width/2,r=e.bbox.y+e.bbox.height+i),P({},e,{x:t,y:r,rotation:a})}))},te=function(e){var t=e.months,o=e.direction,n=e.position,i=e.offset;return t.map((function(e){var t=0,r=0,a=0;return"horizontal"===o&&"before"===n?(t=e.bbox.x+e.bbox.width/2,r=e.bbox.y-i):"horizontal"===o&&"after"===n?(t=e.bbox.x+e.bbox.width/2,r=e.bbox.y+e.bbox.height+i):"vertical"===o&&"before"===n?(t=e.bbox.x-i,r=e.bbox.y+e.bbox.height/2,a=-90):(t=e.bbox.x+e.bbox.width+i,r=e.bbox.y+e.bbox.height/2,a=-90),P({},e,{x:t,y:r,rotation:a})}))},oe=function(e){var t=e.width,o=e.height,n=e.from,i=e.to,r=e.direction,a=e.yearSpacing,d=e.monthSpacing,l=e.daySpacing,c=e.align;return m((function(){return $({width:t,height:o,from:n,to:i,direction:r,yearSpacing:a,monthSpacing:d,daySpacing:l,align:c})}),[t,o,n,i,r,a,d,l,c])},ne=function(e){var t=e.data,o=e.minValue,n=e.maxValue,i=e.colors,r=e.colorScale;return m((function(){if(r)return r;var e=K(t,o,n);return C().domain(e).range(i)}),[t,o,n,i,r])},ie=function(e){var t=e.years,o=e.direction,n=e.yearLegendPosition,i=e.yearLegendOffset;return m((function(){return ee({years:t,direction:o,position:n,offset:i})}),[t,o,n,i])},re=function(e){var t=e.months,o=e.direction,n=e.monthLegendPosition,i=e.monthLegendOffset;return m((function(){return te({months:t,direction:o,position:n,offset:i})}),[t,o,n,i])},ae=function(e){var t=e.days,o=e.data,n=e.colorScale,i=e.emptyColor;return m((function(){return _({days:t,data:o,colorScale:n,emptyColor:i})}),[t,o,n,i])},de=["months","years"],le=["isInteractive","renderWrapper","theme"],ce=function(e){var t=e.margin,a=e.width,d=e.height,l=e.align,c=void 0===l?Z.align:l,u=e.colors,s=void 0===u?Z.colors:u,g=e.colorScale,f=e.data,m=e.direction,v=void 0===m?Z.direction:m,y=e.emptyColor,p=void 0===y?Z.emptyColor:y,x=e.from,S=e.to,L=e.minValue,W=void 0===L?Z.minValue:L,M=e.maxValue,C=void 0===M?Z.maxValue:M,k=e.valueFormat,z=e.legendFormat,V=e.yearLegend,O=void 0===V?Z.yearLegend:V,I=e.yearLegendOffset,H=void 0===I?Z.yearLegendOffset:I,D=e.yearLegendPosition,B=void 0===D?Z.yearLegendPosition:D,E=e.yearSpacing,R=void 0===E?Z.yearSpacing:E,A=e.monthBorderColor,X=void 0===A?Z.monthBorderColor:A,N=e.monthBorderWidth,G=void 0===N?Z.monthBorderWidth:N,J=e.monthLegend,K=void 0===J?Z.monthLegend:J,Q=e.monthLegendOffset,U=void 0===Q?Z.monthLegendOffset:Q,$=e.monthLegendPosition,_=void 0===$?Z.monthLegendPosition:$,ee=e.monthSpacing,te=void 0===ee?Z.monthSpacing:ee,le=e.dayBorderColor,ce=void 0===le?Z.dayBorderColor:le,he=e.dayBorderWidth,ue=void 0===he?Z.dayBorderWidth:he,se=e.daySpacing,ge=void 0===se?Z.daySpacing:se,fe=e.isInteractive,me=void 0===fe?Z.isInteractive:fe,ve=e.tooltip,ye=void 0===ve?Z.tooltip:ve,pe=e.onClick,xe=e.onMouseEnter,be=e.onMouseLeave,Se=e.onMouseMove,we=e.legends,Le=void 0===we?Z.legends:we,We=e.role,Me=void 0===We?Z.role:We,Ce=o(),ke=n(a,d,t),ze=ke.margin,Ve=ke.innerWidth,Oe=ke.innerHeight,Ie=ke.outerWidth,He=ke.outerHeight,De=oe({width:Ve,height:Oe,from:x,to:S,direction:v,yearSpacing:R,monthSpacing:te,daySpacing:ge,align:c}),Be=De.months,Ee=De.years,Pe=F(De,de),Fe=ne({data:f,minValue:W,maxValue:C,colors:s,colorScale:g}),Re=re({months:Be,direction:v,monthLegendPosition:_,monthLegendOffset:U}),Te=ie({years:Ee,direction:v,yearLegendPosition:B,yearLegendOffset:H}),Ye=ae({days:Pe.days,data:f,colorScale:Fe,emptyColor:p}),je=i(z),qe=i(k);return w(r,{width:Ie,height:He,margin:ze,role:Me,children:[Ye.map((function(e){return b(q,{data:e,x:e.x,y:e.y,size:e.size,color:e.color,borderWidth:ue,borderColor:ce,onMouseEnter:xe,onMouseLeave:be,onMouseMove:Se,isInteractive:me,tooltip:ye,onClick:pe,formatValue:qe},e.date.toString())})),Be.map((function(e){return b(Y,{path:e.path,borderWidth:G,borderColor:X},e.date.toString())})),b(j,{months:Re,legend:K,theme:Ce}),b(T,{years:Te,legend:O,theme:Ce}),Le.map((function(e,t){var o=Fe.ticks(e.itemCount).map((function(e){return{id:e,label:je(e),color:Fe(e)}}));return b(h,P({},e,{containerWidth:a,containerHeight:d,data:o}),t)}))]})},he=function(e){var o=e.isInteractive,n=void 0===o?Z.isInteractive:o,i=e.renderWrapper,r=e.theme,a=F(e,le);return b(t,{isInteractive:n,renderWrapper:i,theme:r,children:b(ce,P({isInteractive:n},a))})},ue=M("%Y-%m-%d"),se=function(e){var t,o,n=e.direction,i=e.daySpacing,r=e.offset,a=e.square,d=e.totalDays,l=e.width,c=e.height;"horizontal"===n?(l-=r,t=7,o=Math.ceil(d/7)):(c-=r,o=7,t=Math.ceil(d/7));var h=(c-i*(t+1))/t,u=(l-i*(o+1))/o,s=Math.min(h,u);return{columns:o,rows:t,cellHeight:a?s:h,cellWidth:a?s:u}};var ge=function(e){var t=e.direction,o=e.colorScale,n=e.emptyColor,i=e.from,r=e.to,a=e.data,d=e.cellWidth,l=e.cellHeight,c=e.daySpacing,h=e.offset,u=c,s=c;"horizontal"===t?u+=h:s+=h;var g=i||a[0].date,f=r||a[a.length-1].date,m=V(g)?g:new Date(g),v=V(f)?f:new Date(f),y=D(m,v).map((function(e){return{date:e,day:ue(e)}})).map((function(e){var i=a.find((function(t){return t.day===e.day})),r=function(e){var t=e.startDate,o=e.date,n=e.direction,i=O.count(t,o),r=o.getMonth(),a=o.getFullYear(),d=0,l=0;return"horizontal"===n?(d=i,l=o.getDay()):(d=o.getDay(),l=i),{currentColumn:d,year:a,currentRow:l,firstWeek:i,month:r,date:o}}({startDate:m,date:e.date,direction:t}),h=r.currentColumn,g=r.currentRow,f=r.firstWeek,v=r.year,y=r.month,p=r.date,x={x:u+c*h+d*h,y:s+c*g+l*g};return i?P({},i,{coordinates:x,firstWeek:f,month:y,year:v,date:p,color:o(i.value),width:d,height:l}):P({},e,{coordinates:x,firstWeek:f,month:y,year:v,date:p,color:n,width:d,height:l})}));return y},fe=function(e){var t=e.cellHeight,o=e.cellWidth,n=e.direction,i=e.daySpacing,r=e.ticks,a=void 0===r?[1,3,5]:r,d=e.arrayOfWeekdays,l=void 0===d?["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]:d,c=o+i,h=t+i;return a.map((function(e){return{value:l[e],rotation:"horizontal"===n?0:-90,y:"horizontal"===n?h*(e+1)-h/3:0,x:"horizontal"===n?0:c*(e+1)-c/3}}))},me=function(e){var t=e.direction,o=e.daySpacing,n=e.days,i=e.cellHeight,r=e.cellWidth;return n.reduce((function(e,n){if(e.weeks.length===n.firstWeek){e.weeks.push(n);var a=n.year+"-"+n.month;if(Object.keys(e.months).includes(a))"horizontal"===t?e.months[a].bbox.width=(n.firstWeek-e.months[a].firstWeek)*(r+o):e.months[a].bbox.height=(n.firstWeek-e.months[a].firstWeek)*(i+o);else{var d={x:0,y:0,width:0,height:0};"horizontal"===t?(d.x=n.coordinates.x-o,d.height=i+o,d.width=r+2*o):(d.y=n.coordinates.y-o,d.height=i+2*o,d.width=r+2*o),e.months[a]={date:n.date,bbox:d,firstWeek:n.firstWeek,month:0,year:0}}}return e}),{months:{},weeks:[]})},ve=function(e){var t,o,n=e.from,i=e.to,r=e.data;return t=n?V(n)?n:new Date(n):r[0].date,o=n&&i?V(i)?i:new Date(i):r[r.length-1].date,t.getDay()+E.count(t,o)},ye=g((function(e){var t=e.data,o=e.x,n=e.ry,i=void 0===n?5:n,r=e.rx,a=void 0===r?5:r,d=e.y,l=e.width,c=e.height,h=e.color,u=e.borderWidth,s=e.borderColor,g=e.isInteractive,m=e.tooltip,y=e.onMouseEnter,p=e.onMouseMove,x=e.onMouseLeave,S=e.onClick,w=e.formatValue,W=L(),M=W.showTooltipFromEvent,C=W.hideTooltip,k=f((function(e){if("value"in t){var o=P({},t,{value:w(t.value)});M(v(m,P({},o)),e),null==y||y(t,e)}}),[M,m,t,y,w]),z=f((function(e){if("value"in t){var o=P({},t,{value:w(t.value)});M(v(m,P({},o)),e),null==p||p(t,e)}}),[M,m,t,p,w]),V=f((function(e){"value"in t&&(C(),null==x||x(t,e))}),[C,t,x]),O=f((function(e){return null==S?void 0:S(t,e)}),[t,S]);return b("rect",{x:o,y:d,rx:a,ry:i,width:l,height:c,style:{fill:h,strokeWidth:u,stroke:s},onMouseEnter:g?k:void 0,onMouseMove:g?z:void 0,onMouseLeave:g?V:void 0,onClick:g?O:void 0})})),pe=["isInteractive","renderWrapper","theme"],xe=function(e){var t=e.margin,a=e.width,d=e.height,l=e.square,c=void 0===l?J.square:l,u=e.colors,s=void 0===u?J.colors:u,g=e.colorScale,f=e.emptyColor,v=void 0===f?J.emptyColor:f,y=e.from,p=e.to,x=e.data,S=e.direction,L=void 0===S?J.direction:S,W=e.minValue,M=void 0===W?J.minValue:W,C=e.maxValue,k=void 0===C?J.maxValue:C,z=e.valueFormat,V=e.legendFormat,O=e.monthLegend,I=void 0===O?J.monthLegend:O,H=e.monthLegendOffset,D=void 0===H?J.monthLegendOffset:H,B=e.monthLegendPosition,E=void 0===B?J.monthLegendPosition:B,F=e.weekdayLegendOffset,R=void 0===F?J.weekdayLegendOffset:F,T=e.weekdayTicks,Y=e.dayBorderColor,q=void 0===Y?J.dayBorderColor:Y,A=e.dayBorderWidth,X=void 0===A?J.dayBorderWidth:A,N=e.daySpacing,Z=void 0===N?J.daySpacing:N,G=e.dayRadius,K=void 0===G?J.dayRadius:G,Q=e.isInteractive,U=void 0===Q?J.isInteractive:Q,$=e.tooltip,_=void 0===$?J.tooltip:$,ee=e.onClick,te=e.onMouseEnter,oe=e.onMouseLeave,ie=e.onMouseMove,ae=e.legends,de=void 0===ae?J.legends:ae,le=e.role,ce=void 0===le?J.role:le,he=n(a,d,t),ue=he.margin,pe=he.innerWidth,xe=he.innerHeight,be=he.outerWidth,Se=he.outerHeight,we=m((function(){return x.map((function(e){return P({},e,{date:new Date(e.day+"T00:00:00")})})).sort((function(e,t){return e.day.localeCompare(t.day)}))}),[x]),Le=o(),We=ne({data:we,minValue:M,maxValue:k,colors:s,colorScale:g}),Me=ve({from:y,to:p,data:we}),Ce=se({square:c,offset:R,totalDays:Me,width:pe,height:xe,daySpacing:Z,direction:L}),ke=Ce.cellHeight,ze=Ce.cellWidth,Ve=ge({offset:R,colorScale:We,emptyColor:v,cellHeight:ke,cellWidth:ze,from:y,to:p,data:we,direction:L,daySpacing:Z}),Oe=Object.values(me({daySpacing:Z,direction:L,cellHeight:ke,cellWidth:ze,days:Ve}).months),Ie=fe({direction:L,cellHeight:ke,cellWidth:ze,daySpacing:Z,ticks:T}),He=re({months:Oe,direction:L,monthLegendPosition:E,monthLegendOffset:D}),De=i(z),Be=i(V);return w(r,{width:be,height:Se,margin:ue,role:ce,children:[Ie.map((function(e){return b("text",{transform:"translate("+e.x+","+e.y+") rotate("+e.rotation+")",textAnchor:"left",style:Le.labels.text,children:e.value},e.value)})),Ve.map((function(e){return b(ye,{data:e,x:e.coordinates.x,rx:K,y:e.coordinates.y,ry:K,width:ze,height:ke,color:e.color,borderWidth:X,borderColor:q,onMouseEnter:te,onMouseLeave:oe,onMouseMove:ie,isInteractive:U,tooltip:_,onClick:ee,formatValue:De},e.date.toString())})),b(j,{months:He,legend:I,theme:Le}),de.map((function(e,t){var o=We.ticks(e.itemCount).map((function(e){return{id:e,label:Be(e),color:We(e)}}));return b(h,P({},e,{containerWidth:a,containerHeight:d,data:o}),t)}))]})},be=function(e){var o=e.isInteractive,n=void 0===o?J.isInteractive:o,i=e.renderWrapper,r=e.theme,a=F(e,pe);return b(t,{isInteractive:n,renderWrapper:i,theme:r,children:b(xe,P({isInteractive:n},a))})},Se=function(e){return b(a,{children:function(t){var o=t.width,n=t.height;return b(be,P({width:o,height:n},e))}})},we=function(e){return b(a,{children:function(t){var o=t.width,n=t.height;return b(he,P({width:o,height:n},e))}})},Le=["months","years"],We=["isInteractive","renderWrapper","theme"],Me=function(e,t,o,n,i,r){var a=c(t,e),d=a[0],h=a[1];return o.find((function(e){return"value"in e&&l(e.x+r.left-i/2,e.y+r.top-i/2,n+i,n+i,d,h)}))},Ce=g((function(e){var t=e.margin,r=e.width,a=e.height,l=e.pixelRatio,c=void 0===l?G.pixelRatio:l,h=e.align,g=void 0===h?G.align:h,m=e.colors,v=void 0===m?G.colors:m,S=e.colorScale,w=e.data,W=e.direction,M=void 0===W?G.direction:W,C=e.emptyColor,k=void 0===C?G.emptyColor:C,z=e.from,V=e.to,O=e.minValue,I=void 0===O?G.minValue:O,H=e.maxValue,D=void 0===H?G.maxValue:H,B=e.valueFormat,E=e.legendFormat,R=e.yearLegend,T=void 0===R?G.yearLegend:R,Y=e.yearLegendOffset,j=void 0===Y?G.yearLegendOffset:Y,q=e.yearLegendPosition,A=void 0===q?G.yearLegendPosition:q,X=e.yearSpacing,N=void 0===X?G.yearSpacing:X,Z=e.monthLegend,J=void 0===Z?G.monthLegend:Z,K=e.monthLegendOffset,Q=void 0===K?G.monthLegendOffset:K,U=e.monthLegendPosition,$=void 0===U?G.monthLegendPosition:U,_=e.monthSpacing,ee=void 0===_?G.monthSpacing:_,te=e.dayBorderColor,de=void 0===te?G.dayBorderColor:te,le=e.dayBorderWidth,ce=void 0===le?G.dayBorderWidth:le,he=e.daySpacing,ue=void 0===he?G.daySpacing:he,se=e.isInteractive,ge=void 0===se?G.isInteractive:se,fe=e.tooltip,me=void 0===fe?G.tooltip:fe,ve=e.onClick,ye=e.onMouseEnter,pe=e.onMouseLeave,xe=e.onMouseMove,be=e.legends,Se=void 0===be?G.legends:be,we=y(null),We=n(r,a,t),Ce=We.innerWidth,ke=We.innerHeight,ze=We.outerWidth,Ve=We.outerHeight,Oe=We.margin,Ie=oe({width:Ce,height:ke,from:z,to:V,direction:M,yearSpacing:N,monthSpacing:ee,daySpacing:ue,align:g}),He=Ie.months,De=Ie.years,Be=F(Ie,Le),Ee=ne({data:w,minValue:I,maxValue:D,colors:v,colorScale:S}),Pe=re({months:He,direction:M,monthLegendPosition:$,monthLegendOffset:Q}),Fe=ie({years:De,direction:M,yearLegendPosition:A,yearLegendOffset:j}),Re=ae({days:Be.days,data:w,colorScale:Ee,emptyColor:k}),Te=p(null),Ye=Te[0],je=Te[1],qe=o(),Ae=i(B),Xe=i(E),Ne=L(),Ze=Ne.showTooltipFromEvent,Ge=Ne.hideTooltip;x((function(){var e;if(we.current){we.current.width=ze*c,we.current.height=Ve*c;var t=we.current.getContext("2d");t&&(t.scale(c,c),t.fillStyle=qe.background,t.fillRect(0,0,ze,Ve),t.translate(Oe.left,Oe.top),Re.forEach((function(e){t.fillStyle=e.color,ce>0&&(t.strokeStyle=de,t.lineWidth=ce),t.beginPath(),t.rect(e.x,e.y,e.size,e.size),t.fill(),ce>0&&t.stroke()})),t.textAlign="center",t.textBaseline="middle",t.fillStyle=null!=(e=qe.labels.text.fill)?e:"",t.font=qe.labels.text.fontSize+"px "+qe.labels.text.fontFamily,Pe.forEach((function(e){t.save(),t.translate(e.x,e.y),t.rotate(d(e.rotation)),t.fillText(String(J(e.year,e.month,e.date)),0,0),t.restore()})),Fe.forEach((function(e){t.save(),t.translate(e.x,e.y),t.rotate(d(e.rotation)),t.fillText(String(T(e.year)),0,0),t.restore()})),Se.forEach((function(e){var o=Ee.ticks(e.itemCount).map((function(e){return{id:e,label:Xe(e),color:Ee(e)}}));u(t,P({},e,{data:o,containerWidth:Ce,containerHeight:ke,theme:qe}))})))}}),[we,ke,Ce,ze,Ve,c,Oe,Re,de,ce,S,T,Fe,J,Pe,Se,qe,Xe,Ee]);var Je=f((function(e){if(we.current){var t=Me(e,we.current,Re,Re[0].size,ce,Oe);if(t){if(je(t),!("value"in t))return;var o=P({},t,{value:Ae(t.value),data:P({},t.data)});Ze(s.createElement(me,P({},o)),e),!Ye&&(null==ye||ye(t,e)),null==xe||xe(t,e),Ye&&(null==pe||pe(t,e))}else Ge(),t&&(null==pe||pe(t,e))}}),[we,Ye,Oe,Re,je,Ae,ce,Ze,Ge,ye,xe,pe,me]),Ke=f((function(){je(null),Ge()}),[je,Ge]),Qe=f((function(e){if(ve&&we.current){var t=Me(e,we.current,Re,Re[0].size,ue,Oe);t&&ve(t,e)}}),[we,ue,Oe,Re,ve]);return b("canvas",{ref:we,width:ze*c,height:Ve*c,style:{width:ze,height:Ve},onMouseEnter:ge?Je:void 0,onMouseMove:ge?Je:void 0,onMouseLeave:ge?Ke:void 0,onClick:ge?Qe:void 0})})),ke=function(e){var o=e.isInteractive,n=void 0===o?G.isInteractive:o,i=e.renderWrapper,r=e.theme,a=F(e,We);return b(t,{isInteractive:n,renderWrapper:i,theme:r,children:b(Ce,P({isInteractive:n},a))})},ze=function(e){return b(a,{children:function(t){var o=t.width,n=t.height;return b(ke,P({width:o,height:n},e))}})};export{he as Calendar,ke as CalendarCanvas,we as ResponsiveCalendar,ze as ResponsiveCalendarCanvas,Se as ResponsiveTimeRange,be as TimeRange,_ as bindDaysData,G as calendarCanvasDefaultProps,Z as calendarDefaultProps,ge as computeCellPositions,se as computeCellSize,K as computeDomain,$ as computeLayout,te as computeMonthLegendPositions,me as computeMonthLegends,ve as computeTotalDays,fe as computeWeekdays,ee as computeYearLegendPositions,J as timeRangeDefaultProps,oe as useCalendarLayout,ne as useColorScale,ae as useDays,re as useMonthLegends,ie as useYearLegends};
//# sourceMappingURL=nivo-calendar.es.js.map
